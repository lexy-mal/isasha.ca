<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dino Final</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
  body {
    margin: 0;
    background: #333;
    touch-action: none;
  }
  canvas {
    display: block;
    margin: 0 auto;
    background: white;
  }
</style>
</head>
<body>

<canvas id="game" width="800" height="350"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// CONSTANTS
const groundY = 280;
const GRAVITY = 2000;
const JUMP = -850;

// Dino
let dino = { x: 70, y: 0, w: 40, h: 60, vy: 0, onGround: true };

// Cactus
let cactus = { x: 600, y: 0, w: 40, h: 70 };

let gameOver = false;
let speed = 300;

function reset() {
  dino.y = groundY - dino.h;
  dino.vy = 0;
  dino.onGround = true;

  cactus.x = 600 + Math.random() * 200;
  cactus.y = groundY - cactus.h;

  speed = 300;
  gameOver = false;
}

reset();

function jumpOrRestart() {
  if (gameOver) {
    reset();
    return;
  }
  if (dino.onGround) {
    dino.vy = JUMP;
    dino.onGround = false;
  }
}

window.addEventListener("mousedown", jumpOrRestart);
window.addEventListener("touchstart", jumpOrRestart);
window.addEventListener("keydown", (e) => {
  if (e.code === "Space" || e.code === "ArrowUp") jumpOrRestart();
});

// Collision
function collide(a, b) {
  return !(
    a.x + a.w < b.x ||
    a.x > b.x + b.w ||
    a.y + a.h < b.y ||
    a.y > b.y + b.h
  );
}

let last = 0;
function loop(t) {
  const dt = (t - last) / 1000;
  last = t;

  // Clear
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Background
  ctx.fillStyle = "#ffffff";
  ctx.fillRect(0, 0, 800, 350);

  // Ground
  ctx.fillStyle = "#d2c39b";
  ctx.fillRect(0, groundY, 800, 70);

  if (!gameOver) {
    // Dino physics
    dino.vy += GRAVITY * dt;
    dino.y += dino.vy * dt;

    if (dino.y >= groundY - dino.h) {
      dino.y = groundY - dino.h;
      dino.vy = 0;
      dino.onGround = true;
    }

    // Move cactus
    cactus.x -= speed * dt;

    if (cactus.x + cactus.w < 0) {
      cactus.x = 800 + Math.random() * 200;
      speed += 20;
    }

    // Check collision
    if (collide(dino, cactus)) {
      gameOver = true;
    }
  }

  // Draw cactus
  ctx.fillStyle = "green";
  ctx.fillRect(cactus.x, cactus.y, cactus.w, cactus.h);

  // Draw dino
  ctx.fillStyle = "black";
  ctx.fillRect(dino.x, dino.y, dino.w, dino.h);

  // Draw game over
  if (gameOver) {
    ctx.fillStyle = "rgba(0,0,0,0.5)";
    ctx.fillRect(0, 0, 800, 350);

    ctx.fillStyle = "white";
    ctx.font = "40px Arial";
    ctx.textAlign = "center";
    ctx.fillText("GAME OVER", 400, 160);

    ctx.font = "20px Arial";
    ctx.fillText("Tap / Click / Space to restart", 400, 200);
  }

  requestAnimationFrame(loop);
}

requestAnimationFrame(loop);
</script>

</body>
</html>